# Payment System Manual Testing Checklist

> ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡∏ú‡πà‡∏≤‡∏ô Stripe Test Mode + SlipOK Sandbox
> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 2025-02-13

## Prerequisites

- Stripe Test Mode enabled (‡πÉ‡∏ä‡πâ `sk_test_...` keys)
- SlipOK Sandbox mode (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- ‡∏°‡∏µ test course (published, ‡∏£‡∏≤‡∏Ñ‡∏≤ > 0) ‡πÅ‡∏•‡∏∞ free course
- ‡∏°‡∏µ test bundle (published, ‡∏£‡∏≤‡∏Ñ‡∏≤ > 0)
- ‡∏°‡∏µ test coupon (100% discount) ‡πÅ‡∏•‡∏∞ coupon (partial discount)

## Stripe Test Card Numbers

| Card Number | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå |
|---|---|
| `4242 4242 4242 4242` | ‚úÖ Success |
| `4000 0000 0000 0002` | ‚ùå Decline |
| `4000 0025 0000 3155` | üîê 3D Secure required |
| `4000 0000 0000 9995` | ‚ùå Insufficient funds |

> Exp: ‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï, CVC: 3 ‡∏´‡∏•‡∏±‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ

---

## 1. ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏≠‡∏£‡πå‡∏™ (Stripe)

- [ ] **1.1** ‡∏Å‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤ ‚Üí redirect ‡πÑ‡∏õ Stripe Checkout
- [ ] **1.2** ‡∏à‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ card `4242...` ‚Üí redirect ‡∏Å‡∏•‡∏±‡∏ö ‚Üí enrollment ‡∏™‡∏£‡πâ‡∏≤‡∏á
- [ ] **1.3** ‡πÄ‡∏ä‡πá‡∏Ñ‡∏´‡∏ô‡πâ‡∏≤ Dashboard ‚Üí ‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠
- [ ] **1.4** ‡πÄ‡∏ä‡πá‡∏Ñ Admin ‚Üí payment status = `completed`
- [ ] **1.5** ‡∏Å‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡πÑ‡∏°‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ã‡πâ‡∏≥)

## 2. ‡∏ã‡∏∑‡πâ‡∏≠ Bundle (Stripe)

- [ ] **2.1** ‡∏Å‡∏î‡∏ã‡∏∑‡πâ‡∏≠ Bundle ‚Üí redirect ‡πÑ‡∏õ Stripe Checkout
- [ ] **2.2** ‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Üí enrollment ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÉ‡∏ô Bundle
- [ ] **2.3** ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÉ‡∏ô Bundle ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ
- [ ] **2.4** ‡∏Å‡∏î‡∏ã‡∏∑‡πâ‡∏≠ Bundle ‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏µ‡∏Å (‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß) ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß

## 3. Promo Price

- [ ] **3.1** ‡∏ï‡∏±‡πâ‡∏á promo price ‡∏ó‡∏µ‡πà course ‚Üí ‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ promo
- [ ] **3.2** ‡∏à‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ promo price ‚Üí Stripe amount = promo price (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà original)
- [ ] **3.3** Promo ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‚Üí ‡πÅ‡∏™‡∏î‡∏á original price

## 4. Coupon

- [ ] **4.1** ‡πÉ‡∏™‡πà coupon code ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î
- [ ] **4.2** Coupon ‡∏•‡∏î‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô ‚Üí Stripe amount = ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏•‡∏î
- [ ] **4.3** Coupon ‡∏•‡∏î 100% ‚Üí ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ü‡∏£‡∏µ (‡πÑ‡∏°‡πà redirect ‡πÑ‡∏õ Stripe)
- [ ] **4.4** Coupon ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‚Üí ‡πÅ‡∏à‡πâ‡∏á error
- [ ] **4.5** Coupon ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‚Üí ‡πÅ‡∏à‡πâ‡∏á error
- [ ] **4.6** Coupon ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≠‡∏£‡πå‡∏™ ‚Üí ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
- [ ] **4.7** Coupon + Promo price ‚Üí ‡∏•‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤ promo (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà original)
- [ ] **4.8** ‡πÉ‡∏ä‡πâ coupon ‡πÄ‡∏î‡∏¥‡∏°‡∏ã‡πâ‡∏≥ (‡∏ñ‡πâ‡∏≤ perUserLimit = 1) ‚Üí ‡πÅ‡∏à‡πâ‡∏á error

## 5. Slip Payment (PromptPay)

- [ ] **5.1** ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏¢‡∏≠‡∏î‡∏ï‡∏£‡∏á ‚Üí payment completed + enrollment ‡∏™‡∏£‡πâ‡∏≤‡∏á
- [ ] **5.2** ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏¢‡∏≠‡∏î‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á (‡∏™‡∏•‡∏¥‡∏õ < ‡∏£‡∏≤‡∏Ñ‡∏≤) ‚Üí ‡πÅ‡∏à‡πâ‡∏á error ‡∏¢‡∏≠‡∏î‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á
- [ ] **5.3** ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏ã‡πâ‡∏≥ (reuse) ‚Üí ‡πÅ‡∏à‡πâ‡∏á error ‡∏™‡∏•‡∏¥‡∏õ‡∏ã‡πâ‡∏≥ (code 1003)
- [ ] **5.4** ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏•‡∏¥‡∏õ ‚Üí ‡πÅ‡∏à‡πâ‡∏á error ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
- [ ] **5.5** Slip + Coupon ‚Üí ‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏•‡∏î coupon

## 6. Bundle Slip Payment

- [ ] **6.1** ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Bundle ‚Üí enrollment ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™
- [ ] **6.2** ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô Bundle ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß

## 7. Webhook Reliability

- [ ] **7.1** ‡∏ï‡∏£‡∏ß‡∏à Stripe Dashboard > Webhooks > Recent events ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ failed
- [ ] **7.2** ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Stripe CLI: `stripe trigger checkout.session.completed`
- [ ] **7.3** ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤ payment status ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏õ‡πá‡∏ô `completed` ‡∏ú‡πà‡∏≤‡∏ô webhook

## 8. Admin Payment Management

- [ ] **8.1** Admin ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô status pending ‚Üí completed ‚Üí enrollment ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- [ ] **8.2** Admin ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô status completed ‚Üí refunded ‚Üí enrollment ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö
- [ ] **8.3** Admin ‡∏•‡∏ö payment ‚Üí audit log ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- [ ] **8.4** Admin ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô status ‡∏Ç‡∏≠‡∏á bundle payment ‚Üí enrollment ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

## 9. Edge Cases & Security

- [ ] **9.1** ‡∏Å‡∏î checkout ‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‚Üí ‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á pending payment ‡∏ã‡πâ‡∏≥
- [ ] **9.2** ‡πÅ‡∏Å‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏ô DevTools ‚Üí server ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏≤‡∏Å DB (‡πÑ‡∏°‡πà trust client)
- [ ] **9.3** ‡πÄ‡∏õ‡∏¥‡∏î 2 tab ‡∏Å‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô ‚Üí ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î double enrollment
- [ ] **9.4** ‡πÉ‡∏ä‡πâ paymentId ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô ‚Üí reject (userId ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á)
- [ ] **9.5** ‡πÉ‡∏ä‡πâ paymentId ‡∏Ç‡∏≠‡∏á course A ‡∏Å‡∏±‡∏ö course B ‚Üí reject (courseId ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á)
- [ ] **9.6** Rate limit: ‡∏Å‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô 10 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ ‚Üí 429 Too Many Requests

## 10. Email Notifications

- [ ] **10.1** ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Üí ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö email ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
- [ ] **10.2** ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Üí ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö email ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
- [ ] **10.3** Email ‡πÑ‡∏°‡πà block ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (non-blocking)

---

## ‡∏ß‡∏¥‡∏ò‡∏µ Test ‡∏î‡πâ‡∏ß‡∏¢ Stripe CLI (Local)

```bash
# Install Stripe CLI
# https://stripe.com/docs/stripe-cli

# Login
stripe login

# Forward webhooks to local
stripe listen --forward-to localhost:3000/api/stripe/webhook

# Trigger test event
stripe trigger checkout.session.completed
```

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏π Logs

```bash
# Railway logs
railway logs --tail

# ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏ó‡∏µ‡πà Railway Dashboard > Deployments > Logs
```
