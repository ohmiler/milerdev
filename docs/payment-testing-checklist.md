# Payment System Manual Testing Checklist

> р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ър╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щр╕Фр╣Йр╕зр╕вр╕бр╕╖р╕нр╕Ьр╣Ир╕▓р╕Щ Stripe Test Mode + SlipOK Sandbox
> р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕ер╣Ир╕▓р╕кр╕╕р╕Ф: 2025-02-13

## Prerequisites

- Stripe Test Mode enabled (р╣Гр╕Кр╣Й `sk_test_...` keys)
- SlipOK Sandbox mode (р╕Цр╣Йр╕▓р╕бр╕╡)
- р╕бр╕╡ test course (published, р╕гр╕▓р╕Др╕▓ > 0) р╣Бр╕ер╕░ free course
- р╕бр╕╡ test bundle (published, р╕гр╕▓р╕Др╕▓ > 0)
- р╕бр╕╡ test coupon (100% discount) р╣Бр╕ер╕░ coupon (partial discount)

## Stripe Test Card Numbers

| Card Number | р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М |
|---|---|
| `4242 4242 4242 4242` | тЬЕ Success |
| `4000 0000 0000 0002` | тЭМ Decline |
| `4000 0025 0000 3155` | ЁЯФР 3D Secure required |
| `4000 0000 0000 9995` | тЭМ Insufficient funds |

> Exp: р╕нр╕░р╣Др╕гр╕Бр╣Зр╣Др╕Фр╣Йр╣Гр╕Щр╕нр╕Щр╕▓р╕Др╕Х, CVC: 3 р╕лр╕ер╕▒р╕Бр╕нр╕░р╣Др╕гр╕Бр╣Зр╣Др╕Фр╣Й

---

## 1. р╕Лр╕╖р╣Йр╕нр╕Др╕нр╕гр╣Мр╕к (Stripe)

- [тЬЕ] **1.1** р╕Бр╕Фр╕Лр╕╖р╣Йр╕нр╕Др╕нр╕гр╣Мр╕кр╕Чр╕╡р╣Ир╕бр╕╡р╕гр╕▓р╕Др╕▓ тЖТ redirect р╣Др╕Ы Stripe Checkout
- [тЬЕ] **1.2** р╕Ир╣Ир╕▓р╕вр╕Фр╣Йр╕зр╕в card `4242...` тЖТ redirect р╕Бр╕ер╕▒р╕Ъ тЖТ enrollment р╕кр╕гр╣Йр╕▓р╕З
- [тЬЕ] **1.3** р╣Ар╕Кр╣Зр╕Др╕лр╕Щр╣Йр╕▓ Dashboard тЖТ р╣Ар╕лр╣Зр╕Щр╕Др╕нр╕гр╣Мр╕кр╕Чр╕╡р╣Ир╕Лр╕╖р╣Йр╕н
- [тЬЕ] **1.4** р╣Ар╕Кр╣Зр╕Д Admin тЖТ payment status = `completed`
- [тЬЕ] **1.5** р╕Бр╕Фр╕Лр╕╖р╣Йр╕нр╕Др╕нр╕гр╣Мр╕кр╣Ар╕Фр╕┤р╕бр╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З тЖТ р╣Бр╕Ир╣Йр╕Зр╕зр╣Ир╕▓р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╣Бр╕ер╣Йр╕з (р╣Др╕бр╣Ир╕Ир╣Ир╕▓р╕вр╕Лр╣Йр╕│)

## 2. р╕Лр╕╖р╣Йр╕н Bundle (Stripe)

- [тЬЕ] **2.1** р╕Бр╕Фр╕Лр╕╖р╣Йр╕н Bundle тЖТ redirect р╣Др╕Ы Stripe Checkout
- [тЬЕ] **2.2** р╕Ир╣Ир╕▓р╕вр╕кр╕│р╣Ар╕гр╣Зр╕И тЖТ enrollment р╕кр╕гр╣Йр╕▓р╕Зр╕Чр╕╕р╕Бр╕Др╕нр╕гр╣Мр╕кр╣Гр╕Щ Bundle
- [тЬЕ] **2.3** р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕Чр╕╕р╕Бр╕Др╕нр╕гр╣Мр╕кр╣Гр╕Щ Bundle р╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Фр╣Й
- [тЬЕ] **2.4** р╕Бр╕Фр╕Лр╕╖р╣Йр╕н Bundle р╣Ар╕Фр╕┤р╕бр╕нр╕╡р╕Б (р╕Цр╣Йр╕▓р╣Ар╕гр╕╡р╕вр╕Щр╕Др╕гр╕Ър╣Бр╕ер╣Йр╕з) тЖТ р╣Бр╕Ир╣Йр╕Зр╕зр╣Ир╕▓р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕Др╕гр╕Ър╣Бр╕ер╣Йр╕з

## 3. Promo Price

- [тЬЕ] **3.1** р╕Хр╕▒р╣Йр╕З promo price р╕Чр╕╡р╣И course тЖТ р╕лр╕Щр╣Йр╕▓р╕Кр╕│р╕гр╕░р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕Др╕▓ promo
- [тЬЕ] **3.2** р╕Ир╣Ир╕▓р╕вр╕Фр╣Йр╕зр╕в promo price тЖТ Stripe amount = promo price (р╣Др╕бр╣Ир╣Гр╕Кр╣И original)
- [тЬЕ] **3.3** Promo р╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕ тЖТ р╣Бр╕кр╕Фр╕З original price

## 4. Coupon

- [тЬЕ] **4.1** р╣Гр╕кр╣И coupon code р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З тЖТ р╣Бр╕кр╕Фр╕Зр╕кр╣Ир╕зр╕Щр╕ер╕Ф
- [тЬЕ] **4.2** Coupon р╕ер╕Фр╕Ър╕▓р╕Зр╕кр╣Ир╕зр╕Щ тЖТ Stripe amount = р╕гр╕▓р╕Др╕▓р╕лр╕ер╕▒р╕Зр╕ер╕Ф
- [тЬЕ] **4.3** Coupon р╕ер╕Ф 100% тЖТ р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕Яр╕гр╕╡ (р╣Др╕бр╣И redirect р╣Др╕Ы Stripe)
- [тЬЕ] **4.4** Coupon р╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕ тЖТ р╣Бр╕Ир╣Йр╕З error
- [тЬЕ] **4.5** Coupon р╣Гр╕Кр╣Йр╕Др╕гр╕Ър╕Ир╕│р╕Щр╕зр╕Щ тЖТ р╣Бр╕Ир╣Йр╕З error
- [тЬЕ] **4.6** Coupon р╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Фр╣Ар╕Йр╕Юр╕▓р╕░р╕Др╕нр╕гр╣Мр╕к тЖТ р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ър╕Др╕нр╕гр╣Мр╕кр╕нр╕╖р╣Ир╕Щр╣Др╕бр╣Ир╣Др╕Фр╣Й
- [тЬЕ] **4.7** Coupon + Promo price тЖТ р╕ер╕Фр╕Ир╕▓р╕Бр╕гр╕▓р╕Др╕▓ promo (р╣Др╕бр╣Ир╣Гр╕Кр╣И original)
- [тЬЕ] **4.8** р╣Гр╕Кр╣Й coupon р╣Ар╕Фр╕┤р╕бр╕Лр╣Йр╕│ (р╕Цр╣Йр╕▓ perUserLimit = 1) тЖТ р╣Бр╕Ир╣Йр╕З error

## 5. Slip Payment (PromptPay)

- [тЬЕ] **5.1** р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З р╕вр╕нр╕Фр╕Хр╕гр╕З тЖТ payment completed + enrollment р╕кр╕гр╣Йр╕▓р╕З
- [тЬЕ] **5.2** р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╕вр╕нр╕Фр╣Др╕бр╣Ир╕Хр╕гр╕З (р╕кр╕ер╕┤р╕Ы < р╕гр╕▓р╕Др╕▓) тЖТ р╣Бр╕Ир╣Йр╕З error р╕вр╕нр╕Фр╣Др╕бр╣Ир╕Хр╕гр╕З
- [тЬЕ] **5.3** р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╕Лр╣Йр╕│ (reuse) тЖТ р╣Бр╕Ир╣Йр╕З error р╕кр╕ер╕┤р╕Ыр╕Лр╣Йр╕│ (code 1003)
- [тЬЕ] **5.4** р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╣Гр╕Кр╣Ир╕кр╕ер╕┤р╕Ы тЖТ р╣Бр╕Ир╣Йр╕З error р╕нр╣Ир╕▓р╕Щр╣Др╕бр╣Ир╣Др╕Фр╣Й
- [тЬЕ] **5.5** Slip + Coupon тЖТ р╕вр╕нр╕Фр╕Кр╕│р╕гр╕░р╕лр╕ер╕▒р╕Зр╕ер╕Ф coupon

## 6. Bundle Slip Payment

- [тЬЕ] **6.1** р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╕кр╕│р╕лр╕гр╕▒р╕Ъ Bundle тЖТ enrollment р╕Чр╕╕р╕Бр╕Др╕нр╕гр╣Мр╕к
- [тЬЕ] **6.2** р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ Bundle р╕Др╕гр╕Ър╕Чр╕╕р╕Бр╕Др╕нр╕гр╣Мр╕кр╣Бр╕ер╣Йр╕з тЖТ р╣Бр╕Ир╣Йр╕Зр╕зр╣Ир╕▓р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕Др╕гр╕Ър╣Бр╕ер╣Йр╕з

## 7. Webhook Reliability

- [тЬЕ] **7.1** р╕Хр╕гр╕зр╕И Stripe Dashboard > Webhooks > Recent events тЖТ р╣Др╕бр╣Ир╕бр╕╡ failed
- [тЬЕ] **7.2** р╕Чр╕Фр╕кр╕нр╕Ъ Stripe CLI: `stripe trigger checkout.session.completed`
- [тЬЕ] **7.3** р╕Хр╕гр╕зр╕Ир╕зр╣Ир╕▓ payment status р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Ар╕Ыр╣Зр╕Щ `completed` р╕Ьр╣Ир╕▓р╕Щ webhook

## 8. Admin Payment Management

- [тЬЕ] **8.1** Admin р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ status pending тЖТ completed тЖТ enrollment р╕кр╕гр╣Йр╕▓р╕Зр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- [тЬЕ] **8.2** Admin р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ status completed тЖТ refunded тЖТ enrollment р╕Цр╕╣р╕Бр╕ер╕Ъ
- [тЬЕ] **8.3** Admin р╕ер╕Ъ payment тЖТ audit log р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б
- [тЬЕ] **8.4** Admin р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ status р╕Вр╕нр╕З bundle payment тЖТ enrollment р╕Чр╕╕р╕Бр╕Др╕нр╕гр╣Мр╕кр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

## 9. Edge Cases & Security

- [тЬЕ] **9.1** р╕Бр╕Ф checkout р╣Ар╕гр╣Зр╕зр╣Ж р╕лр╕ер╕▓р╕вр╕Др╕гр╕▒р╣Йр╕З тЖТ р╣Др╕бр╣Ир╕кр╕гр╣Йр╕▓р╕З pending payment р╕Лр╣Йр╕│
- [тЬЕ] **9.2** р╣Бр╕Бр╣Йр╕гр╕▓р╕Др╕▓р╣Гр╕Щ DevTools тЖТ server р╕Др╕│р╕Щр╕зр╕Ур╕гр╕▓р╕Др╕▓р╕Ир╕▓р╕Б DB (р╣Др╕бр╣И trust client)
- [тЬЕ] **9.3** р╣Ар╕Ыр╕┤р╕Ф 2 tab р╕Бр╕Фр╕Лр╕╖р╣Йр╕нр╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Щ тЖТ р╣Др╕бр╣Ир╣Ар╕Бр╕┤р╕Ф double enrollment
- [тЬЕ] **9.4** р╣Гр╕Кр╣Й paymentId р╕Вр╕нр╕Зр╕Др╕Щр╕нр╕╖р╣Ир╕Щ тЖТ reject (userId р╣Др╕бр╣Ир╕Хр╕гр╕З)
- [тЬЕ] **9.5** р╣Гр╕Кр╣Й paymentId р╕Вр╕нр╕З course A р╕Бр╕▒р╕Ъ course B тЖТ reject (courseId р╣Др╕бр╣Ир╕Хр╕гр╕З)
- [тЬЕ] **9.6** Rate limit: р╕Бр╕Фр╕Лр╕╖р╣Йр╕нр╣Ар╕гр╣Зр╕зр╣Ар╕Бр╕┤р╕Щ 10 р╕Др╕гр╕▒р╣Йр╕З/р╕Щр╕▓р╕Чр╕╡ тЖТ 429 Too Many Requests

## 10. Email Notifications

- [тЬЕ] **10.1** р╕Лр╕╖р╣Йр╕нр╕Др╕нр╕гр╣Мр╕кр╕кр╕│р╣Ар╕гр╣Зр╕И тЖТ р╣Др╕Фр╣Йр╕гр╕▒р╕Ъ email р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ
- [тЬЕ] **10.2** р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И тЖТ р╣Др╕Фр╣Йр╕гр╕▒р╕Ъ email р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ
- [тЬЕ] **10.3** Email р╣Др╕бр╣И block р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ (non-blocking)

---

## р╕зр╕┤р╕Шр╕╡ Test р╕Фр╣Йр╕зр╕в Stripe CLI (Local)

```bash
# Install Stripe CLI
# https://stripe.com/docs/stripe-cli

# Login
stripe login

# Forward webhooks to local
stripe listen --forward-to localhost:3000/api/stripe/webhook

# Trigger test event
stripe trigger checkout.session.completed
```

## р╕зр╕┤р╕Шр╕╡р╕Фр╕╣ Logs

```bash
# Railway logs
railway logs --tail

# р╕лр╕гр╕╖р╕нр╕Фр╕╣р╕Чр╕╡р╣И Railway Dashboard > Deployments > Logs
```
